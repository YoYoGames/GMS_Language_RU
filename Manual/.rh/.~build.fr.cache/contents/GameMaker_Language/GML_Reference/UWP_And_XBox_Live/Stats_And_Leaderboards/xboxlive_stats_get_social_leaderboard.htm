
  
  xboxlive_stats_get_social_leaderboard
  Эта функция может быть использована для получения социальной таблицы рейтингов для заданной статистики. Вы предоставляете идентификатор пользователя (который возвращается, например, функцией xboxlive_get_user()), строку
    stat string (как определено при его создании с помощью функций xboxlive_stats_set_stat_*), а затем указываете ряд подробностей о том, какую информацию о таблице лидеров вы хотите получить. Обратите внимание, что вы можете получить социальную таблицу лидеров только для
    int или real stats, но не для string stats, и что если вы отметите аргумент "favourites_only" как true, то результаты будут содержать данные только для тех друзей, которые отмечены пользователем как "любимые".
  ВАЖНО! Статы, используемые в социальных таблицах лидеров, не нужно регистрировать как "Featured Stats" в XDP/WindowsDev Center...
  Функция создаст обратный вызов, который вызовет системное асинхронное событие. Это событие будет иметь специальную карту DS async_load    которая затем должна быть разобрана на наличие следующих ключей:
  
    " id" - Будет содержать константу achievement_stat_event
    " event" - Будет содержать строку "GetLeaderboardComplete".
    " userid" - Идентификатор пользователя, связанный с запросом
    " error" - 0 в случае успеха, другое значение, если произошла ошибка. Ниже приведены наиболее часто возвращаемые ошибки:
      
        -2145844848: Неправильный запрос (статистика не является допустимым типом таблицы лидеров, т.е. строкой)
      
    
    " errormessage" - Строка с сообщением об ошибке, если таковое имеется
    "display_name" - Уникальный ID для таблицы лидеров, определенный на приборной панели провайдера.
    " numentries" - Количество записей в таблице лидеров, которые вы получили.
  
  Остальная часть карты DS также будет содержать данные таблицы лидеров со следующим форматом (где "N" - позиция в таблице лидеров, от 0 до "numentries"):
  
    "PlayerN" - Имя игрока, где "N" - целочисленное значение, соответствующее его позиции в списке лидеров.
    "PlayeridN" - Уникальный идентификатор пользователя игрока, "N".
    " RankN" - Ранг игрока "N" в таблице лидеров.
    " ScoreN" - счет игрока "N".
  
   
  Синтаксис:
  xboxlive_stats_get_social_leaderboard(user_id, stat, num_entries, start_rank, start_at_user, favourites_only);
  
    
      
        Аргумент
        Описание
      
      
        идентификатор пользователя
        Идентификатор пользователя, для которого нужно получить таблицу лидеров
      
      
        статистика
        Статистика (в виде строки) для создания глобальной таблицы лидеров
      
      
        num_entries
        Количество записей из глобальной таблицы лидеров для извлечения
      
      
        начальный_ранг
        Ранг в таблице лидеров, с которого нужно начинать (используйте 0, если аргумент "start_at_user" установлен в true)
      
      
        start_at_user
        Устанавливается в true, чтобы начать с ранга ID пользователя, false в противном случае (устанавливается в false, если аргумент "start_rank" не равен 0).
      
      
        избранное_только
        Установите значение true, чтобы показывать только тех друзей, которые отмечены как "любимые", или false в противном случае 
      
    
  
   
  Возвращается:
  Н/Д
   
  Расширенный пример:
  Ниже приведен расширенный пример использования этой функции. Для начала вы должны вызвать ее в каком-либо событии, например, в событии Room Start или Create:
  xboxlive_stats_get_social_leaderboard(user_id, "GlobalTime", 20, 1, false, false);
  Приведенный выше код будет вызван для получения списка всех позиций в глобальной таблице лидеров в игре и сгенерирует обратный вызов Social Asynchronous Event, с которым мы поступим следующим образом:
  if (async_load[? "id"] == achievement_stat_event) {
     if (async_load[? "event"] == "GetLeaderboardComplete") {
     global.numentries = async_load[? "numentries"]; for(var i = 0; i < numentries; i++;) {
     global.playername[i] = async_load[? "Player" + string(i)]; global.playerid[i] = async_load[? "Playerid" + string(i)]; global.playerrank[i] = async_load[? "Rank" + string(i)]; global.playerscore[i] = async_load[? "Score" + string(i]); }
     }
     }
  
  Приведенный выше код проверяет возвращенную карту DS в Social Asynchronous Event, и если ее "id" совпадает с проверяемой константой, он затем проверяет, было ли событие вызвано возвращенными данными таблицы лидеров, после чего перебирает карту
    и сохраняет все различные значения в нескольких глобальных массивах.
   
   
   
  
    
      
        Назад: Статистика и таблицы лидеров
        Далее: xboxlive_achievements_set_progress
      
    
    © Copyright YoYo Games Ltd. 2021 Все права защищены
  
  
  

