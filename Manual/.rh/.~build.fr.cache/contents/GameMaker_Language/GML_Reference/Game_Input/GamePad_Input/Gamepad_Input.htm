
  
  GamepadInput
  GameMaker Studio 2 имеет ряд специальных функций, которые можно использовать для обнаружения аналоговых и цифровых элементов управления с нескольких подключенных геймпадов. Эти функции работают аналогично функциям Device Inputs,
    Вы можете обнаружить до четырех различных подключенных геймпадов XInput (и до 8 геймпадов DirectInput) и обрабатывать входные данные от каждого из них с помощью одних и тех же функций. Обратите внимание, что когда геймпад подключается к вашему устройству (или извлекается)
    запускается асинхронное системное событие, в котором вы можете действовать в соответствии с ситуацией, используя соответствующие функции.
  Слоты для геймпадов индексируются от 0 вверх, и фактический слот, назначенный геймпаду, зависит от множества факторов, не последним из которых является ОС, на которой работает проект. На Windows цели, слоты 0 -
    3 включительно предназначены только для геймпадов Xinput, то есть контроллеров Xbox360 и совместимых с ними. Однако вы также можете проверить слоты 4 - 11 включительно для геймпадов DirectInput, что означает, что вы можете обнаружить множество других моделей контроллеров при подключении
    через эти слоты. На других платформах геймпады могут быть обнаружены в любом слоте, назначенном ОС, это может быть слот 3, слот 20 или более. Например, Android устройства будут хранить геймпады bluetooth в слоте и затем резервировать
    Поэтому нельзя считать, что один подключенный геймпад подключен к слоту 0, так как это, скорее всего, не так.
  Стоит отметить, что при использовании геймпадов DirectInput на Windows или общих геймпадов на других платформах, приведенные ниже константы могут не соответствовать кнопкам, которые вы ожидаете увидеть при нажатии, из-за фрагментарного и
    нестандартизированного способа реализации API производителями контроллеров. В связи с этим рекомендуется использовать в играх экран настройки геймпада, на котором можно переопределить кнопки геймпада на основе данных, полученных от любого подключенного устройства.
    (существуют функции "отображения" геймпада, которые могут помочь в этом на Windows Desktop, Ubuntu, macOS и Android , в то время как на всех остальных вам придется делать это самостоятельно с помощью кода).
  Входные константы
  При работе с функциями геймпада входные данные могут поступать от осей, кнопок или шляп, которые GameMaker Studio 2 присвоит следующим встроенным константам (обратите внимание, что "шляпы" обычно
    обнаруживаются только на нестандартных контроллерах):
  
    
      
        Постоянная
        Описание
      
      
        gp_face1
        Верхняя кнопка 1 (соответствует кнопке "A" на контроллере Xbox 360 и кресту на контроллере PS )
      
      
        gp_face2
        Верхняя кнопка 2 (соответствует кнопке "B" на контроллере Xbox 360 и кругу на контроллере PS )
      
      
        gp_face3
        Верхняя кнопка 3 (соответствует "X" на контроллере Xbox 360 и квадрату на контроллере PS )
      
      
        gp_face4
        Верхняя кнопка 4 (соответствует букве "Y" на контроллере Xbox 360 и треугольнику на контроллере PS )
      
      
        gp_shoulderl
        Пуговица на левом плече
      
      
        gp_shoulderlb
        Спусковой крючок левого плеча
      
      
        gp_shoulderr
        Правая плечевая кнопка
      
      
        gp_shoulderrb
        Спусковой крючок правого плеча
      
      
        gp_select
        Кнопка выбора (это кнопка PS на контроллере DS4)
      
      
        gp_start
        Кнопка запуска (это кнопка "опции" на контроллере PS4)
      
      
        gp_stickl
        Левый стик нажат (как кнопка)
      
      
        gp_stickr
        Правый стик нажат (как кнопка)
      
      
        gp_padu
        D-пад вверх
      
      
        gp_padd
        D-пад вниз
      
      
        gp_padl
        D-pad влево
      
      
        gp_padr
        D-pad вправо
      
      
        gp_axislh
        Горизонтальная ось левого стика (аналоговая)
      
      
        gp_axislv
        Вертикальная ось левого стика (аналоговая)
      
      
        gp_axisrh
        Горизонтальная ось правого стика (аналоговая)
      
      
        gp_axisrv
        Вертикальная ось правого стика (аналоговая)
      
    
  
  Чтобы лучше понять, какую именно часть контроллера представляет каждая константа, вы можете обратиться к следующему изображению стандартного геймпада XInput:
  
  Следующие константы могут быть использованы с функцией gamepad_axis_value() при использовании геймпада DualSense на PS4 или PS5:
  
    
      
        Постоянная
        Описание
      
      
        gp_axis_acceleration_x
        Ускорение геймпада по оси X
      
      
        gp_axis_acceleration_y
        Ускорение геймпада по оси Y
      
      
        gp_axis_acceleration_z
        Ускорение геймпада по оси Z
      
      
        gp_axis_angular_velocity_x
        Угловая скорость геймпада по оси X
      
      
        gp_axis_angular_velocity_y
        Угловая скорость геймпада по оси Y
      
      
        gp_axis_angular_velocity_z
        Угловая скорость геймпада по оси Z
      
      
        gp_axis_orientation_x
        Ориентация геймпада по оси X
      
      
        gp_axis_orientation_y
        Ориентация геймпада по оси Y
      
      
        gp_axis_orientation_z
        Ориентация геймпада по оси Z
      
      
        gp_axis_orientation_w
        Ориентация геймпада по оси W
      
    
  
  ПРИМЕЧАНИЕ: Ориентация геймпада - это кватернион , поэтому он имеет четыре значения (X, Y, Z и W).
  В настоящее время эти константы поддерживаются только на PS4 и PS5, при использовании на других платформах функции ввода возвращают 0, даже при использовании геймпада DualSense.
  Функции
  Ниже приведен список всех функций геймпада:
  
    gamepad_is_supported
    gamepad_is_connected
    gamepad_get_guid
    gamepad_get_device_count
    gamepad_get_description
    gamepad_get_button_threshold
    gamepad_get_axis_deadzone
    gamepad_get_option
    gamepad_set_button_threshold
    gamepad_set_axis_deadzone
    gamepad_set_vibration
    gamepad_set_colour
    gamepad_set_option
    gamepad_axis_count
    значение_оси_геймпада
    проверка_кнопки_геймпада
    gamepad_button_check_pressed
    gamepad_button_check_released
    счётчик_кнопок_геймпада
    значение_кнопки_геймпада
    gamepad_hat_count
    gamepad_hat_value
  
   
  Существуют также следующие функции геймпада, которые используются для переназначения встроенных констант на прямые физические входы данного геймпада. Эти функции предназначены только для целевых платформ Windows Desktop, Ubuntu, macOS и Android, а в Windows,
    они будут действительны только для устройств прямого ввода. Хотя GameMaker Studio 2 поставляется с отображениями для ряда различных геймпадов на основе SDL Gamepad Controller DB, однако
    из-за огромного количества типов и марок контроллеров невозможно сопоставить константы GML с правильными входами для каждой марки и модели, поэтому с помощью этих функций у вас есть возможность создать собственные пользовательские сопоставления.
   
  
    gamepad_get_mapping
    gamepad_test_mapping
    gamepad_remove_mapping
  
   
  Стоит отметить, что геймпады с прямым вводом работают в кооперативном режиме, что означает, что ваша игра имеет к ним доступ только тогда, когда она является приложением переднего плана, что, в свою очередь, приведет к тому, что контроллеры прямого ввода будут "потеряны", если игра потеряет фокус, а затем снова "найдены", когда она вернется в фокус (это можно определить по системному событию).
    игра теряет фокус, а затем снова "находит", когда возвращается в фокус (это может быть обнаружено в системном событии и обработано). Аналогично, никакой ввод от геймпадов не будет обнаружен, пока игра не в фокусе, и мы рекомендуем вам
    использовать функцию os_is_paused() или window_has_focus() чтобы обнаружить это и поставить игру на паузу или что-то подобное.
    Так как любая кнопка, удерживаемая в момент, когда игра теряет фокус, будет удерживаться до тех пор, пока игра не вернет фокус.
   
  Совместимость
  В приведенном ниже списке указана текущая совместимость платформ (обратите внимание, что она будет меняться с будущими обновлениями):
  
    Windows полностью поддерживается, причем одновременно можно подключить до 12 устройств (нумерация от 0 до 11, причем 0 - 3 - устройства XInput, а 4 - 11 - DirectInput). Также разрешено переназначение констант контроллера.
    macOS поддерживается не более 4 подключенных устройств одновременно, причем эти устройства могут быть ТОЛЬКО типа Playstation3или Xbox 360. Обратите внимание, что опция "Build for Mac AppStore" в Mac Game Options
      должна быть ВЫКЛЮЧЕНА, чтобы поддержка пэдов работала. Также разрешено переназначение констант контроллера.
    Ubuntu также поддерживает ввод с геймпада, но вам может потребоваться установить дополнительные библиотеки из репозитория Ubuntu. Вы можете сделать это легко, открыв терминал командной строки и набрав следующее (это установит поддержку GUI
      для джойстика/геймпада, а также сам API джойстика/геймпада - перестановка констант контроллера не разрешена):
     sudo apt-get install jstest-gtk sudo apt-get install joystick.

    
    HTML5-игры с использованием геймпадов поддерживаются большинством основных браузеров, кроме Safari. Переназначение констант контроллера не допускается.
    Поддержка геймпадов также распространяется на iOS с корпусом iCade. Левая ось соответствует контроллеру стиков (хотя вход цифровой, а не аналоговый), четыре кнопки "лица" соответствуют передним кнопкам корпуса, а четыре кнопки "плеча" соответствуют кнопкам на задней панели корпуса.
      плечевые кнопки соответствуют кнопкам на задней панели корпуса.
    Android (и Amazon Fire) поддерживает контроллеры NYKO и общие контроллеры Bluetooth, но только если они включены, что означает, что вам придется отметить опцию iCade/Bluetooth в разделе " Общие" в опциях игры Android. Для их полноценной работы требуется уровень API 12, и следует отметить, что GameMaker Studio 2 зарегистрирует как подключенные все Bluetooth-устройства, с которыми сопряжено ваше устройство, независимо от того, подключено оно на самом деле или нет.
      подключено. Поэтому это следует учитывать при назначении и проверке "слотов". Обратите внимание, что также разрешено переназначение констант контроллера.
    На PS4, если вы хотите использовать отслеживание сенсорной панели, вам нужно использовать device_mouse_* кнопки. Переназначение констант контроллера не допускается.
    На Windows UWP, XBoxOne и Nintendo Switch цели, геймпады полностью поддерживаются, но ремаппинг констант контроллера не допускается.
  
  В идеале, на всех целевых платформах вы хотите перечислить список доступных "слотов" для геймпадов, а затем проверить, обнаружены ли какие-либо устройства, примерно так:
  var _maxpads = gamepad_get_device_count();
     for (var i = 0; i < _maxpads; i++) {
     if (gamepad_is_connected(i)) {
     // делаем что-то с пэдом "i" }
     }
  
   
   
  
    
      
        Назад: Игровой вход
        Следующее: Виртуальные клавиши и виртуальные клавиатуры
      
    
    © Copyright YoYo Games Ltd. 2021 Все права защищены
  
  
  

