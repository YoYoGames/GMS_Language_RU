
  
  http_request
  С помощью этой функции вы можете создать запрос HTTP-заголовка для определения рабочих параметров HTTP-транзакции, что может быть использовано для многих вещей, таких как (например) аутентификация через HTTP-заголовки, если вы используете RESTful API. Функция требует
    полный IP-адрес сервера, с которого нужно сделать запрос, а также тип запроса (в виде строки, см. примечание ниже): "GET", "HEAD", "POST", "PUT", "DELETE", "TRACE", "OPTIONS",
    или "CONNECT". Вам также нужно будет предоставить DS map пар ключ/значение (в виде строк, где ключ - это поле заголовка, а значение - необходимые данные для заголовка), и
    последний аргумент - необязательная строка данных, которую вы можете добавить в запрос, и если она не нужна, то это может быть либо 0, либо пустая строка "". Обратите внимание, что вы также можете отправить буфер (подробнее см. раздел " Буферы" ), в этом случае последним аргументом будет "хэндл" буфера для отправки.
  ПРИМЕЧАНИЕ: HTTP-заголовки обычно имеют формат "ключ:значение", но поскольку GMS создает эти пары для вас из ds_map, нет необходимости включать двоеточие ":" в строки ключей и значений вашей карты.
  ПРИМЕЧАНИЕ: При использовании буфера для аргумента body, если позиция поиска буфера находится в начале (0), то тело не отправляется и буфер заполняется ответом от http-вызова, но если позиция поиска буфера ненулевая, то содержимое строки буфера
    содержимое строки отправляется в качестве тела.
  ПРИМЕЧАНИЕ: Вы должны знать, что из-за XSS-защиты в браузерах запросы и попытки загрузить ресурсы из других доменов блокируются и могут возвращать пустые результаты. Более подробную информацию см. в разделе " Междоменные проблемы ".
  Это событие генерирует "обратный звонок", который подхватывается любым HTTP-событием, и в этом случае генерируется DS Map ( более известная как "словарь")
    которая является эксклюзивной для этого события и хранится в специальной переменной async_load. Эта DS карта имеет следующие два ключа, связанные с функцией запроса:
  
    id: ID, который был возвращен командой. Если вы отправляете серию http_ запросов, то вам нужно знать, на какой из них вы получаете ответ, поэтому вы будете использовать это значение для сравнения со значением, которое вы сохранили, когда первоначально
      чтобы найти нужный запрос.
    response_headers: Если это значение больше или равно 0, оно содержит карту DS, которая содержит HTTP-заголовки, возвращенные с ответом на HTTP-запрос.
  
   
  Синтаксис:
  http_request(url, method, header_map, body);
  
    
      
        Аргумент
        Описание
      
      
        url
        Веб-адрес сервера, с которого вы хотите получить информацию
      
      
        метод
        Метод запроса (обычно "POST" или "GET", но поддерживаются все методы)
      
      
        карта заголовков
        Карта ds_map с необходимыми полями заголовка
      
      
        тело
        Данные, которые будут переданы после заголовков (могут быть двоичным буфером).
      
    
  
   
  Возвращается:
  Реально
   
  Пример:
  var map = ds_map_create(); ds_map_add(map, "Host", "225.0.0.97:3000"); ds_map_add(map, "Connection", "keep-alive"); ds_map_add(map, "Content-Length", "169"); ds_map_add(map,
    "Cache-Control", "max-age=0"); ds_map_add(map, "Authorization", "Basic eW95b19hZG1pbjpjNG5lZmllbGQ="); ds_map_add(map, "Accept", "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"); ds_map_add(map, "User-Agent", "Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.57 Safari/537.36"); ds_map_add(map, "Content-Type", "application/x-www-form-urlencoded"); ds_map_add(map, "Accept-Encoding", "gzip,deflate,sdch"); ds_map_add(map, "Accept-Language", "en-GB,en-US;q=0.8,en;q=0.6"); ds_map_add(map, "Cookie", "request_method=GET; _InAppPurchases_session=69bb6ef6eec2b"); var data="utf8=%E2%9C%93&authenticity_token=kPmS14DcYcuKgMFZUsN3XFfj3mhs%3D&product%5Bname%5D=CatchTheHaggis&product%5Bproduct_id%5D=http_test&commit=Create+Product"; request = http_request("http:225.0.0.97:3000/products",
    "POST", map, data);
  Приведенный выше код создает карту DS с соответствующими HTTP-заголовками для функции, затем создает строку данных для использования, поскольку это POST-запрос. Наконец, функция вызывается, при этом ее значение ID сохраняется в переменной "request" для
    для проверки в асинхронном событии HTTP.
   
   
   
  
    
      
        Назад: HTTP
        Далее: http_get
      
    
    © Copyright YoYo Games Ltd. 2021 Все права защищены
  
  
  

